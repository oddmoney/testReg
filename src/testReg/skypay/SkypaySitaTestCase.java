package testReg.skypay;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;

import org.json.JSONObject;

public class SkypaySitaTestCase {

	public static void main(String[] args) {
		try {
			testEcase();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	private static void testEcase() throws Exception {
		String[][] val = {
/* #1-01 */ {"1-01","MC************1450","110301","S","JCV7G","210528"},	{"1-01","MC************1450","110301","S","H8CG9","210526"},	{"1-01","MC************1450","110301","S","HKF1K","210527"},	{"1-01","MC************1450","110301","S","JYMCR","210527"},
/* #1-02 */ {"1-02","MC************1450","110302","F","JCV8E","210528"},	{"1-02","MC************1450","110302","F","H8CGS","210526"},	{"1-02","MC************1450","110302","F","JYME8","210527"},	{"1-02","MC************1450","110302","F","JYMFS","210527"},
/* #1-03 */ {"1-03","CLNPAAAAA1231235959","","S","JCV96","210528"},			{"1-03","CLNPAAAAA1231235959","","S","H8BZM","210526"},			{"1-03","CLNPAAAAA1231235959","","S","H8CKH","210526"},			{"1-03","CLNPAAAAA1231235959","","S","H8CMG","210526"},
/* #1-04 */ {"1-04","CLNPAAAAA1231235958","","F","JCV9K","210528"},			{"1-04","CLNPAAAAA1231235958","","F","H8C5G","210526"},			{"1-04","CLNPAAAAA1231235958","","F","H8CRJ","210526"},			{"1-04","CLNPAAAAA1231235958","","F","H8CTP","210526"},
/* #1-05 */ {"1-05","CLKPAAAAA1231235959","","S","JCVBF","210528"},
/* #1-06 */ {"1-06","CLKPAAAAA1231235958","","F","JCVBR","210528"},
/* #1-07 */ {"1-07","CLSPAAAAA1231235959","","S","JCVDF","210528"},
/* #1-08 */ {"1-08","CLSPAAAAA1231235958","","F","JCVDV","210528"},
/* #1-09 */ {"1-09","CLAT229086","","S","JCVE9","210528"},					{"1-09","CLAT229086","","S","H8C5X","210526"},					{"1-09","CLAT229086","","S","H8CYR","210526"},					{"1-09","CLAT229086","","S","HZD11","210526"},
/* #1-10 */ {"1-10","CLAT229087","","F","JCVEY","210528"},					{"1-10","CLAT229087","","F","H8C64","210526"},					{"1-10","CLAT229087","","F","HZDRL","210526"},					{"1-10","CLAT229087","","F","J88QG","210527"},
/* #1-11 */ {"1-11","CLTSAAAAA1231235959","","S","JCVF4","210528"},
/* #1-12 */ {"1-12","CLTSAAAAA1231235958","","F","JXT2M","210528"},
/* #1-13 */ {"1-13","CLPLAAAAA1231235959","","S","JXT34","210528"},			{"1-13","CLPLAAAAA1231235959","","S","H8C6Q","210526"},			{"1-13","CLPLAAAAA1231235959","","S","HZD2L","210526"},			{"1-13","CLPLAAAAA1231235959","","S","J895P","210527"},
/* #1-14 */ {"1-14","CLPLAAAAA1231235958","","F","JXT3Q","210528"},			{"1-14","CLPLAAAAA1231235958","","F","H8C7C","210526"},			{"1-14","CLPLAAAAA1231235958","","F","HZD5G","210526"},			{"1-14","CLPLAAAAA1231235958","","F","J897Q","210527"},
/* #1-15 */ {"1-15","CLWCAAAAA1231235959","","S","JXT47","210528"},			{"1-15","CLWCAAAAA1231235959","","S","H8C80","210526"},			{"1-15","CLWCAAAAA1231235959","","S","HZDBC","210526"},			{"1-15","CLWCAAAAA1231235959","","S","J89D4","210527"},
/* #1-16 */ {"1-16","CLWCAAAAA1231235958","","F","JXT4V","210528"},			{"1-16","CLWCAAAAA1231235958","","F","H8C8N","210526"},			{"1-16","CLWCAAAAA1231235958","","F","HZDFK","210526"},			{"1-16","CLWCAAAAA1231235958","","F","J89K5","210527"},
/* #1-17 */ {"1-17","CLUPAAAAA1231235959","","S","JXT5C","210528"},
/* #1-18 */ {"1-18","CLUPAAAAA1231235958","","F","JXT5Z","210528"},
/* #1-19 */ {"1-19","CLAPAAAAA1231235959","","S","JXT6H","210528"},
/* #1-20 */ {"1-20","CLAPAAAAA1231235958","","F","JXT7D","210528"},
/* #1-21 */ {"1-21","CLCPAAAAA1231235959","","S","JXT7R","210528"},
/* #1-22 */ {"1-22","CLCPAAAAA1231235958","","F","JXT8E","210528"},
/* #1-23 */ {"1-23","CLEC2101050001305346","","S","JXT94","210528"},		{"1-23","CLEC2101050001305346","","S","H8C9H","210526"},		{"1-23","CLEC2101050001305346","","S","HZDHP","210526"},		{"1-23","CLEC2101050001305346","","S","J89MT","210527"},
/* #1-24 */ {"1-24","CLEC2101050001305347","","F","JXT9P","210528"},		{"1-24","CLEC2101050001305347","","F","H8CB3","210526"},		{"1-24","CLEC2101050001305347","","F","HZDKL","210526"},		{"1-24","CLEC2101050001305347","","F","J89NQ","210527"},
/* #1-25 */ {"1-25","CLAWAAAAA1231235959","","S","JXTB3","210528"}, 		{"1-25","CLAWAAAAA1231235959","","S","H8CBB","210526"}, 		{"1-25","CLAWAAAAA1231235959","","S","HZDND","210526"}, 		{"1-25","CLAWAAAAA1231235959","","S","J89RD","210527"},
/* #1-26 */ {"1-26","CLAWAAAAA1231235958","","F","JXTB9","210528"}, 		{"1-26","CLAWAAAAA1231235958","","F","H8CCS","210526"}, 		{"1-26","CLAWAAAAA1231235958","","F","HZDQM","210526"}, 		{"1-26","CLAWAAAAA1231235958","","F","J89T7","210527"},
/* #1-27 */ {"1-27","CLAKAAAAA1231235958","","S","JXTBK","210528"},
/* #1-28 */ {"1-28","CLAKAAAAA1231235957","","F","JXT8E","JXTC1"},
/* #1-29 */ {"1-29","FTFT2012MCD0375","","S","JXTCD","210528"},
/* #1-30 */ {"1-30","FTFT2012MCD0376","","F","JXTCP","JXTC1"},
/* #2-01 */ {"2-01","MC************1450","110301","S","JXTD2","210528"},	{"2-01","MC************1450","110301","S","H8CE3","210526"},	{"2-01","MC************1450","110301","S","JYMLJ","210527"},	{"2-01","MC************1450","110301","S","JYMW0","210527"},
		    {"2-01","CLNPAAAAA1231235959","","S","JXTD2","210528"},			{"2-01","CLNPAAAAA1231235959","","S","H8CE3","210526"},			{"2-01","CLNPAAAAA1231235959","","S","JYMLJ","210527"},			{"2-01","CLNPAAAAA1231235959","","S","JYMW0","210527"},
/* #2-02 */ {"2-02","MC************1450","110301","S","JXTDJ","210528"},
		    {"2-02","FTFT2012MCD0375","","S","JXTDJ","210528"},
/* #2-03 */ {"2-03","CLNPAAAAA1231235959","","S","JXTE0","210528"},			{"2-03","CLNPAAAAA1231235959","","S","H8CH6","210526"},			{"2-03","CLNPAAAAA1231235959","","S","JYMZJ","210527"},			{"2-03","CLNPAAAAA1231235959","","S","JYN0Z","210527"},
		    {"2-03","FTFT2012MCD0375","","S","JXTE0","210528"},				{"2-03","FTFT2012MCD0375","","S","H8CH6","210526"},				{"2-03","FTFT2012MCD0375","","S","JYMZJ","210527"},				{"2-03","FTFT2012MCD0375","","S","JYN0Z","210527"},
/* #3-01 */ {"3-01","CLNPAAAAA1231235959","","S","JXTER","210528"},			{"3-01","CLNPAAAAA1231235959","","S","H8CJP","210526"},			{"3-01","CLNPAAAAA1231235959","","S","HM23P","210527"},			{"3-01","CLNPAAAAA1231235959","","S","HM25Y","210527"},
/* #3-02 */ {"3-02","CLKPAAAAA1231235959","","S","JXTGV","210528"},
/* #3-03 */ {"3-03","MC************1450","110301","S","JXTHR","210528"},	{"3-03","CLNPAAAAA1231235959","110301","S","H8CLZ","210526"},	{"3-03","CLNPAAAAA1231235959","110301","S","HM37H","210527"},	{"3-03","CLNPAAAAA1231235959","110301","S","HM3CC","210527"},
/* #3-04 */ {"3-04","CLNPAAAAA1231235959","","S","JXTJX","210528"},			{"3-04","CLNPAAAAA1231235959","","S","H8CP4","210526"},			{"3-04","CLNPAAAAA1231235959","","S","HM3GP","210527"},			{"3-04","CLNPAAAAA1231235959","","S","HM3MP","210527"},
		    {"3-04","FTFT2012MCD0375","","S","JXTJX","210528"},				{"3-04","FTFT2012MCD0375","","S","H8CP4","210526"},				{"3-04","FTFT2012MCD0375","","S","HM3GP","210527"},				{"3-04","FTFT2012MCD0375","","S","HM3MP","210527"},
		    {"3-04","CLNPAAAAA1231235959","","S","JXTJX","210528"},			{"3-04","CLNPAAAAA1231235959","","S","H8CP4","210526"},			{"3-04","CLNPAAAAA1231235959","","S","HM3GP","210527"},			{"3-04","CLNPAAAAA1231235959","","S","HM3MP","210527"},
/* #3-05 */ {"3-05","MC************1450","110301","S","JXTLE","210528"},
		    {"3-05","FTFT2012MCD0375","","S","JXTLE","210528"},
		    {"3-05","MC************1450","110301","S","JXTLE","210528"},
/* #4-1-1 */{"4-1-1","CLNPAAAAA1231235959","","S","JXTMS","210528"},		{"4-1-1","CLNPAAAAA1231235959","","S","H8CQX","210526"},		{"4-1-1","CLNPAAAAA1231235959","","S","JYN2J","210527"},		{"4-1-1","CLNPAAAAA1231235959","","S","JYN3V","210527"},
		    {"4-1-1","MC************1450","110301","S","JXTMS","210528"},	{"4-1-1","MC************1450","110301","S","H8CQX","210526"},	{"4-1-1","MC************1450","110301","S","JYN2J","210527"},	{"4-1-1","MC************1450","110301","S","JYN3V","210527"},
/* #4-2-1 */{"4-2-1","CLNPAAAAA1231235959","","S","JXTP3","210528"},		{"4-2-1","CLNPAAAAA1231235959","","S","H8CTW","210526"},		{"4-2-1","CLNPAAAAA1231235959","","S","JYN5H","210527"},		{"4-2-1","CLNPAAAAA1231235959","","S","JYN66","210527"},
		    {"4-2-1","CLAKAAAAA1231235958","","S","JXTP3","210528"},		{"4-2-1","CLAKAAAAA1231235958","","S","H8CTW","210526"},		{"4-2-1","CLAKAAAAA1231235958","","S","JYN5H","210527"},		{"4-2-1","CLAKAAAAA1231235958","","S","JYN66","210527"},
/* #4-3-1 */{"4-3-1","MC************1450","110301","S","JXTRD","210528"},	{"4-3-1","MC************1450","110301","S","H8CVW","210526"},	{"4-3-1","MC************1450","110301","S","JYN85","210527"},	{"4-3-1","MC************1450","110301","S","JYNB2","210527"},
		    {"4-3-1","FTFT2012MCD0375","","S","JXTRD","210528"},			{"4-3-1","FTFT2012MCD0375","","S","H8CVW","210526"},			{"4-3-1","FTFT2012MCD0375","","S","JYN85","210527"},			{"4-3-1","FTFT2012MCD0375","","S","JYNB2","210527"},
/* #4-3-2 */{"4-3-2","CLNPAAAAA1231235959","","S","JXTRD","210528"},		{"4-3-2","CLNPAAAAA1231235959","","S","H8CVW","210526"},		{"4-3-2","CLNPAAAAA1231235959","","S","JYN85","210527"},		{"4-3-2","CLNPAAAAA1231235959","","S","JYNB2","210527"},
/* #4-4-1 */{"4-4-1","CLNPAAAAA1231235959","","S","JXTTE","210528"},
		    {"4-4-1","FTFT2012MCD0375","","S","JXTTE","210528"},
/* #4-4-2 */{"4-4-2","MC************1450","110301","S","JXTTE","210528"},
/* #5-1-1 EX */
/* #5-1-2 */{"5-1-2","MC************1450","110301","S","JXTZD","210528"},	{"5-1-2","MC************1450","110301","S","HZD2B","210526"},	{"5-1-2","MC************1450","110301","S","J89WB","210527"},	{"5-1-2","MC************1450","110301","S","HSFF0","210528"},
/* #5-2-1 EX */
/*        EX */
/* #5-2-2 */{"5-2-2","CLNPAAAAA1231235959","","S","JXV1R","210528"},
/* #5-3-1 EX */
/*        EX */
/* #5-3-2 */{"5-3-2","CLKPAAAAA1231235959","","S","JXV5W","210528"},		{"5-3-2","CLKPAAAAA1231235959","","S","HZD5X","210526"},		{"5-3-2","CLKPAAAAA1231235959","","S","JXGLG","210528"},
/* #5-4-1 EX */
/* #5-4-2 EX */
/* #5-4-3 */{"5-4-3","CLKPAAAAA1231235959","","S","JXV8H","210528"},
/* #5-5-1 EX */
/* #5-5-2 EX */
/* #5-5-3 EX */
/* #5-5-4 */{"5-5-4","CLKPAAAAA1231235959","","S","JXV9S","210528"},		{"5-5-4","CLKPAAAAA1231235959","","S","HZD86","210526"},		{"5-5-4","CLKPAAAAA1231235959","","S","JXTY5","210527"},		{"5-5-4","CLKPAAAAA1231235959","","S","JYM6L","210528"},
/* #5-6-1 EX */
/*        EX */
/* #5-6-2 */{"5-6-2","CLKPAAAAA1231235959","","S","JXVDY","210528"},		{"5-6-2","CLKPAAAAA1231235959","","S","HZDDJ","210526"},		{"5-6-2","CLKPAAAAA1231235959","","S","JXG72","210528"},		{"5-6-2","CLKPAAAAA1231235959","","S","JCVW3","210528"},
/* #6-01 */ {"6-01","MC************1450","110301","S","JXVG2","210528"},	{"6-01","MC************1450","110301","S","HZDG4","210526"},	{"6-01","MC************1450","110301","S","HM3EJ","210527"},	{"6-01","MC************1450","110301","S","HSFRC","210528"},
/* #6-02 */ {"6-02","CLNPAAAAA1231235959","","S","JXVH0","210528"},			{"6-02","CLNPAAAAA1231235959","","S","HZDGJ","210526"},			{"6-02","CLNPAAAAA1231235959","","S","HM3LV","210527"},			{"6-02","CLNPAAAAA1231235959","","S","J7BPL","210528"},
/* #6-03 */ {"6-03","MC************1450","110301","S","JXVHS","210528"},	{"6-03","MC************1450","110301","S","HZDGY","210526"},	{"6-03","MC************1450","110301","S","HM3R2","210527"},	{"6-03","MC************1450","110301","S","JCV9L","210528"},
		    {"6-03","FTFT2012MCD0375","","S","JXVHS","210528"},				{"6-03","FTFT2012MCD0375","","S","HZDGY","210526"},				{"6-03","FTFT2012MCD0375","","S","HM3R2","210527"},				{"6-03","FTFT2012MCD0375","","S","JCV9L","210528"},
/* #6-04 */ {"6-04","CLNPAAAAA1231235959","","S","JXVJV","210528"},			{"6-04","CLNPAAAAA1231235959","","S","HZDJK","210526"},			{"6-04","CLNPAAAAA1231235959","","S","HM3VB","210527"},			{"6-04","CLNPAAAAA1231235959","","S","JCVP3","210528"},
		    {"6-04","FTFT2012MCD0375","","S","JXVJV","210528"},				{"6-04","FTFT2012MCD0375","","S","HZDJK","210526"},				{"6-04","FTFT2012MCD0375","","S","HM3VB","210527"},				{"6-04","FTFT2012MCD0375","","S","JCVP3","210528"}
		};
		
		//int payId = 227;
		//for (String[] v : val) {
		//	testEcaseSub(payId++, v);
		//}
		String testa[] = {"6-04","MCXXXXXXXXXXXX1450","110301","S","DS9ME","210528"};
		testEcaseSub(159719, testa);
	}
	private static void testEcaseSub(int payId, String[] v) throws Exception {
		HttpURLConnection conn = null;
		OutputStream os = null;
		InputStream is = null;
		BufferedReader br = null;
		StringBuffer data = new StringBuffer();
		String param = "{" + 
				" \"pnrAlpha\" : \"O" + v[4] +"\", " +
				" \"approvalNum\" : \"" + v[2] +"\", " +
				" \"paymentId\" : \"" + payId + "\", " +
				" \"skySpeedId\" : \"12345678\", " +
				" \"bookId\" : \"56789\", " +
				" \"paymentTypeCode\" : \"" + (v[1].matches("^CL.*") ? "MV" : (v[1].matches("^FT.*") ? "FT" : "CV")) + "\", " +
				" \"currency\" : \"KRW\", " +
				" \"amount\" : \"21200\", " +
				" \"sitaPayInfo\" : \"" + v[1] + "\", " +
				" \"issuedDate\" : \"" + (v[5].length()==6?v[5].replaceAll("([0-9]{2})([0-9]{2})([0-9]{2})", "$3$2$1"):"") + "\" " +
					"}";
		JSONObject json = new JSONObject(param);
		try {
			URL sUrl = new URL("http://dpae.jejuair.net/paeg/skypay/requestCancel/v1.0");
			//URL sUrl = new URL("http://localhost:9080/paeg/skypay/requestCancel/v1.0");
			conn = (HttpURLConnection) sUrl.openConnection();
			conn.setRequestProperty("Content-Type", "application/json");
			conn.setRequestProperty("Connection", "keep-alive");
			conn.setRequestProperty("Accept", "*/*");
			conn.setRequestMethod("POST");
			conn.setDoInput(true);
			conn.setDoOutput(true);
			os = conn.getOutputStream();
			os.write(json.toString().getBytes());
			os.flush();
			os.close();
			is = conn.getInputStream();
			br = new BufferedReader(new InputStreamReader(is));
			String line;
			while ((line = br.readLine()) != null) data.append(line);
		}catch(Exception e) {
			e.printStackTrace(); 
		}finally {
			if (os != null) os.close();
			if (br != null) br.close();
			if (is != null) is.close();
			if (conn != null) conn.disconnect();
		}
		JSONObject jsonRes = new JSONObject(data.toString());
		System.out.println("[" + v[0] + "]==========\nRequest:"+param.toString()+"\nResponse:"+jsonRes.toString());
	}
}
